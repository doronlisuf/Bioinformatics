#load counts expression data (normalize it)
matrix_of_data <- as.matrix(read.table("GSE119290_Readhead_2018_RNAseq_gene_counts.txt"))
coldata<-read.csv("coldata.csv",header = T,row.names=1,stringsAsFactors=T)
dds <- DESeqDataSetFromMatrix(countData = matrix_of_data,colData = coldata,design = ~ dex)
dds <- dds[rowSums(counts(dds)) > 1,]
#create distance matrix with the top 5000 variable genes
mads=apply(matrix_of_data,1,mad)
d=matrix_of_data[rev(order(mads))[1:5000],]
d=sweep(d,1, apply(d,1,median,na.rm=T))
d = scale(d)
di <- dist(d)
#perform hclustering and plot dendrogram
hc <- hclust(di, method="ward.D")
#draw heatmap with clusters and dendrograms
vst <- vst(dds,blind = FALSE)
sampleDists <- dist(t(assay(vst)))
sampleDists
sampleDistMatrix <- as.matrix( sampleDists )
rownames(sampleDistMatrix) <- paste( vst$V1, sep = " - " )
colnames(sampleDistMatrix) <- NULL
colors <- colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
sampleDistMatrix
#Heatmap of sample-to-sample distances
pheatmap(sampleDistMatrix,clustering_distance_rows = sampleDists,
clustering_distance_cols = sampleDists,col = colors)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
#load counts expression data (normalize it)
matrix_of_data <- as.matrix(read.table("GSE119290_Readhead_2018_RNAseq_gene_counts.txt"))
coldata<-read.csv("coldata.csv",header = T,row.names=1,stringsAsFactors=T)
dds <- DESeqDataSetFromMatrix(countData = matrix_of_data,colData = coldata,design = ~ dex)
#create distance matrix with the top 5000 variable genes
mads=apply(matrix_of_data,1,mad)
d=matrix_of_data[rev(order(mads))[1:5000],]
d=sweep(d,1, apply(d,1,median,na.rm=T))
d = scale(d)
di <- dist(d)
#perform hclustering and plot dendrogram
hc <- hclust(di, method="ward.D")
#draw heatmap with clusters and dendrograms
hc01.col <- hcopt(dist(t(d)),method="ward.D")
## use 1-correlation as distance for for rows/genes
## use ward as agglomeration rule
hc01.row <- hcopt(as.dist(1-cor(t(d))),method="ward.D")
library(DESeq2)
library(DOSE)
library(BS831)
library(Biobase)
library(BS831)
library(Biobase)
library(pheatmap)
library(DESeq2)
library(DOSE)
library(BS831)
library(Biobase)
library(pheatmap)
library(mclust)
library(ConsensusClusterPlus)
library(cba)
#create distance matrix with the top 5000 variable genes
mads=apply(matrix_of_data,1,mad)
d=matrix_of_data[rev(order(mads))[1:5000],]
d=sweep(d,1, apply(d,1,median,na.rm=T))
d = scale(d)
di <- dist(d)
#perform hclustering and plot dendrogram
hc <- hclust(di, method="ward.D")
plot(hc)
#draw heatmap with clusters and dendrograms
hc01.col <- hcopt(dist(t(d)),method="ward.D")
assayData <- Biobase::exprs(cancerSet)
## use Eculidean distance for columns/samples
## use ward as agglomeration rule
hc01.col <- hcopt(dist(t(assayData)),method="ward.D")
devtools::install_github("montilab/BS831")
install_github("montilab/BS831")
devtools::install_github("montilab/BS831")
library(gplots)
#draw heatmap with clusters and dendrograms
cols <- palette(brewer.pal(8, "Dark2"))[as.fumeric(tissue)]
head(cbind(colnames(e),cols))
head(cbind(colnames(d),cols))
#draw heatmap with clusters and dendrograms
cols <- palette(brewer.pal(8, "Dark2"))[256]
head(cbind(colnames(d),cols))
#draw heatmap with clusters and dendrograms
col <- colorRampPalette(brewer.pal(10, "RdYlBu"))(256)
heatmap(d, scale = "none", col =  col,
RowSideColors = rep(c("blue", "pink"), each = 16),
ColSideColors = c(rep("purple", 5), rep("orange", 6)))
heatmap.2(d, scale = "none", col = bluered(100),
trace = "none", density.info = "none")
pheatmap(df, cutree_rows = 4)
pheatmap(df, cutree_rows = 4)
pheatmap(d, cutree_rows = 4)
library(dendextend)
row_dend = hclust(dist(d)) # row clustering
col_dend = hclust(dist(t(d))) # column clustering
Heatmap(df, name = "mtcars",
row_names_gp = gpar(fontsize = 6.5),
cluster_rows = color_branches(row_dend, k = 4),
cluster_columns = color_branches(col_dend, k = 2))
library(ComplexHeatmap)
install.packages("ComplexHeatmap")
library(ComplexHeatmap)
row_dend = hclust(dist(d)) # row clustering
col_dend = hclust(dist(t(d))) # column clustering
Heatmap(df, name = "mtcars",
row_names_gp = gpar(fontsize = 6.5),
cluster_rows = color_branches(row_dend, k = 4),
cluster_columns = color_branches(col_dend, k = 2))
BiocManager::install("ComplexHeatmap")
row_dend = hclust(dist(d)) # row clustering
col_dend = hclust(dist(t(d))) # column clustering
Heatmap(df, name = "mtcars",
row_names_gp = gpar(fontsize = 6.5),
cluster_rows = color_branches(row_dend, k = 4),
cluster_columns = color_branches(col_dend, k = 2))
Heatmap(d, name = "mtcars",
row_names_gp = gpar(fontsize = 6.5),
cluster_rows = color_branches(row_dend, k = 4),
cluster_columns = color_branches(col_dend, k = 2))
library(ComplexHeatmap)
Heatmap(d, name = "mtcars",
row_names_gp = gpar(fontsize = 6.5),
cluster_rows = color_branches(row_dend, k = 4),
cluster_columns = color_branches(col_dend, k = 2))
Heatmap(d, name = "mtcars",
row_names_gp = gpar(fontsize = 6),
cluster_rows = color_branches(row_dend, k = 2),
cluster_columns = color_branches(col_dend, k = 2))
Heatmap(d, name = "expression",
row_names_gp = gpar(fontsize = 2),
cluster_rows = color_branches(row_dend, k = 2),
cluster_columns = color_branches(col_dend, k = 2))
Heatmap(d, name = "expression",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(row_dend, k = 2),
cluster_columns = color_branches(col_dend, k = 2))
row_dend = hclust(dist(d), method="ward.D") # row clustering
col_dend = hclust(dist(t(d)), method="ward.D") # column clustering
Heatmap(d, name = "expression",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(row_dend, k = 7),
cluster_columns = color_branches(col_dend, k = 2))
plot(hc)
row_dend = hclust(dist(d), method="ward.D") # row clustering
col_dend = hclust(dist(t(d)), method="ward.D") # column clustering
Heatmap(d, name = "expression",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(row_dend, k = 2),
cluster_columns = color_branches(col_dend, k = 2))
?Heatmap
?color_branches
Heatmap(d, name = "expression",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(row_dend, k = 2, groupLabels = TRUE),
cluster_columns = color_branches(col_dend, k = 2))
library(dendextend)
library(ComplexHeatmap)
row_dend = hclust(dist(d), method="ward.D") # row clustering
col_dend = hclust(dist(t(d)), method="ward.D") # column clustering
Heatmap(d, name = "expression",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(row_dend, k = 2, groupLabels = TRUE),
cluster_columns = color_branches(col_dend, k = 2, groupLabels = TRUE))
Heatmap(d, name = "expression",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(row_dend, k = 2, groupLabels = c(1,2)),
cluster_columns = color_branches(col_dend, k = 2, groupLabels = TRUE))
Heatmap(d, name = "expression",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(row_dend, k = 2, groupLabels = c(1,2)),
cluster_columns = color_branches(col_dend, k = 2, groupLabels = c(0,1)))
?cluster_rows
??cluster_rows
Heatmap(
d,
name = "expression",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(
row_dend,
k = 2,
groupLabels=TRUE
),
cluster_columns = color_branches(
col_dend,
k = 2,
groupLabels=c(0,1)
)
)
Heatmap(
d,
name = "expression",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(
row_dend,
k = 2,
groupLabels = 1:2
),
cluster_columns = color_branches(
col_dend,
k = 2,
groupLabels=c(0,1)
)
)
Heatmap(
d,
name = "expression",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(
row_dend,
k = 2,
groupLabels = 0:1
),
cluster_columns = color_branches(
col_dend,
k = 2,
groupLabels=c(0,1)
)
)
?HeatmapAnnotation
col = list(cluster = c("1" = "pink", "2" = "darkgreen"))
ha <- HeatmapAnnotation(
col = col
)
col = c("1" = "pink", "2" = "darkgreen")
ha <- HeatmapAnnotation(
col = col
)
ha <- HeatmapAnnotation(
col = col_dend
)
col = list(cluster = c("1" = "pink", "2" = "darkgreen"))
ha <- HeatmapAnnotation(
cluster = col_dend,
col = col
)
col = list(cluster = c("1" = "pink", "2" = "darkgreen"))
ha <- HeatmapAnnotation(
cluster = d,
col = col
)
Heatmap(
d,
name = "expression",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(
row_dend,
k = 2,
groupLabels = 0:1
),
cluster_columns = color_branches(
col_dend,
k = 2,
groupLabels=c(0,1)
),
top_annotation = ha
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(
row_dend,
k = 2,
groupLabels = 0:1
),
cluster_columns = color_branches(
col_dend,
k = 2,
groupLabels=c(0,1)
),
top_annotation = ha
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(
row_dend,
k = 2,
groupLabels = 0:1
),
cluster_columns = color_branches(
col_dend,
k = 2,
groupLabels=c(0,1)
)
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(
row_dend,
k = 2,
groupLabels = 0:1
),
cluster_columns = color_branches(
col_dend,
k = 2,
groupLabels=c(0,1)
),
row_km = 2,
column_km = 2
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(
row_dend,
k = 2,
groupLabels = 0:1
),
cluster_columns = color_branches(
col_dend,
k = 2,
groupLabels=c(0,1)
),
row_split = 2
)
row_dend = as.dendrogram(hclust(dist(d), method="ward.D")) # row clustering
col_dend = as.dendrogram(hclust(dist(t(d)), method="ward.D")) # column clustering
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = color_branches(
row_dend,
k = 2,
groupLabels = 0:1
),
cluster_columns = color_branches(
col_dend,
k = 2,
groupLabels=c(0,1)
),
row_split = 2
)
row_dend = as.dendrogram(hclust(dist(d), method="ward.D"))# row clustering
row_dend = color_branches(row_dend, k = 2)
col_dend = as.dendrogram(hclust(dist(t(d)), method="ward.D")) # column clustering
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = (color_branches = row_dend),
cluster_columns = color_branches(
col_dend,
k = 2,
groupLabels=c(0,1)
),
row_split = 2
)
library(dendextend)
library(ComplexHeatmap)
row_dend = as.dendrogram(hclust(dist(d), method="ward.D"))# row clustering
row_dend = color_branches(row_dend, k = 2)
col_dend = as.dendrogram(hclust(dist(t(d)), method="ward.D")) # column clustering
col_dend = color_branches(col_dend, k = 2)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
row_split = 2
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
row_split = 2,
column_split 2
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
row_split = 2,
column_split 2
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
row_split = 2,
column_split = 2
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
column_title_gp = gpar(fill = c("red", "blue", "green"), font = 1:3),
row_split = 2,
column_split = 2
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
column_title_gp = gpar(fill = c("red", "blue"), font = 1:2),
row_split = 2,
column_split = 2
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = "Genes",
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
row_split = 2,
column_split = 2
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = c("Genes", "Test"),
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
row_split = 2,
column_split = 2
)
Heatmap(
d,
name = "expression",
column_title = "Samples",
row_title = c("Genes", "Test"),
row_title_rot = 0,
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
row_split = 2,
column_split = 2
)
Heatmap(
d,
name = "expression",
column_title = c("Samples", "Test"),
column_title_title_rot = 0,
row_title = c("Genes", "Test"),
row_title_rot = 0,
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
row_split = 2,
column_split = 2
)
Heatmap(
d,
name = "expression",
column_title = c("Samples", "Test"),
row_title = c("Genes", "Test"),
row_title_rot = 0,
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
row_split = 2,
column_split = 2
)
Heatmap(
d,
name = "expression",
column_title = c("Cluster 1", "Cluster 2"),
row_title = c("Cluster 1", "Cluster 2"),
row_title_rot = 0,
row_names_gp = gpar(fontsize = 7),
cluster_rows = row_dend,
cluster_columns = col_dend,
row_split = 2,
column_split = 2
)
